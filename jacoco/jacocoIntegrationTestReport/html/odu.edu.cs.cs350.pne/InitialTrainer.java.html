<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>InitialTrainer.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Project-CS350</a> &gt; <a href="index.source.html" class="el_package">odu.edu.cs.cs350.pne</a> &gt; <span class="el_source">InitialTrainer.java</span></div><h1>InitialTrainer.java</h1><pre class="source lang-java linenums">package odu.edu.cs.cs350.pne;

import java.io.File;
import java.io.IOException;
import java.util.*;

import weka.core.Attribute;
import weka.core.DenseInstance;
import weka.core.Instance;
import weka.core.Instances;
import weka.core.converters.ConverterUtils.DataSink;


//-------------------------------------------------
//************ Data Flow (Temporary) **************
//-------------------------------------------------

/**
 * The Initial Trainer creates an initial arff file from raw train data (until sample files are provided) if no file already exists.
 * In other words, it creates an arff file on the program's first execution.
 */
public class InitialTrainer
{
    /**
     * An array of valid category keys.
     */
<span class="nc" id="L27">    private final String[] categoryKeys = {&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;, &quot;F&quot;, &quot;G&quot;, &quot;H&quot;, &quot;I&quot;, &quot;J&quot;, &quot;K&quot;};</span>

    /**
     * An array of data lines that hold information about a simulated document.
     */
    private String[] trainData;  
    
    /**
     * An array of vocab words that correlate with data from simulated documents.
     */
    private String[] vocabWords;  
    
    /**
     * A VocabCollection created from the simulated train data.
     */
<span class="nc" id="L42">    private VocabCollection tempVocab = new VocabCollection();</span>

    public InitialTrainer()
<span class="nc" id="L45">    {</span>
        // String[] tempData = {&quot;&quot;};   //category last
        // String[] tempVocab = {&quot;&quot;};
        // String[] tempData = {&quot;1.7,1.3,3,0,A&quot;,&quot;1.3,3,4,0,B&quot;,&quot;1.5,0,0,2,C&quot;};
        // String[] tempVocab = {&quot;computer&quot;, &quot;data&quot;, &quot;java&quot;, &quot;test&quot;}; 
<span class="nc" id="L50">        String[] tempData = {&quot;3.46,0,0,0,0,0,0,0,0,0,0,A&quot;,</span>
                             &quot;0,3.46,0,0,0,0,0,0,0,0,0,B&quot;,
                             &quot;0,0,3.46,0,0,0,0,0,0,0,0,C&quot;,
                             &quot;0,0,0,3.46,0,0,0,0,0,0,0,D&quot;,
                             &quot;0,0,0,0,3.46,0,0,0,0,0,0,E&quot;,
                             &quot;0,0,0,0,0,3.46,0,0,0,0,0,F&quot;,
                             &quot;0,0,0,0,0,0,3.46,0,0,0,0,G&quot;,
                             &quot;0,0,0,0,0,0,0,3.46,0,0,0,H&quot;,
                             &quot;0,0,0,0,0,0,0,0,3.46,0,0,I&quot;,
                             &quot;0,0,0,0,0,0,0,0,0,3.46,0,J&quot;,
                             &quot;0,0,0,0,0,0,0,0,0,0,3.46,K&quot;};
<span class="nc" id="L61">        String[] tempVocab = {&quot;literature&quot;, &quot;hardware&quot;, &quot;organization&quot;, &quot;software&quot;, &quot;data&quot;, &quot;theory&quot;, &quot;math&quot;, &quot;information&quot;,</span>
                             &quot;method&quot;, &quot;application&quot;, &quot;milieux&quot;};
        
<span class="nc" id="L64">        trainData = tempData;</span>
<span class="nc" id="L65">        vocabWords = tempVocab;</span>
<span class="nc" id="L66">    }</span>

    //For Testing Purposes
    public InitialTrainer(String[] tempData, String[] tempVocab)
<span class="nc" id="L70">    {</span>
<span class="nc" id="L71">        trainData = tempData;</span>
<span class="nc" id="L72">        vocabWords = tempVocab;</span>
<span class="nc" id="L73">    }</span>
    
    public void run()
    {
<span class="nc" id="L77">        String arffPath = &quot;acmclass-data/train.arff&quot;;</span>
<span class="nc bnc" id="L78" title="All 2 branches missed.">        if (validARFFPresent(arffPath))</span>
<span class="nc" id="L79">            return;</span>

<span class="nc" id="L81">        String vocabPath = &quot;acmclass-data/vocabCollection.txt&quot;;</span>
<span class="nc" id="L82">        File vocabFile = new File(vocabPath);</span>
<span class="nc bnc" id="L83" title="All 2 branches missed.">        if (vocabFile.exists()) //guard against prior runs</span>
<span class="nc" id="L84">            vocabFile.delete();</span>
<span class="nc" id="L85">        tempVocab.readInVocab(vocabPath);   //no path exists so it creates a new vocabFile</span>
<span class="nc" id="L86">        simulateVocabConstruction();</span>
<span class="nc" id="L87">        tempVocab.writeOutVocab(vocabPath); </span>
<span class="nc" id="L88">        Instances dTraining = dataExtractionWithData();</span>
<span class="nc" id="L89">        outputToARFF(dTraining, arffPath);</span>
<span class="nc" id="L90">    }</span>

    public boolean validARFFPresent(String arffPath)
    {
<span class="nc" id="L94">        File file = new File(arffPath);</span>
        try {
<span class="nc bnc" id="L96" title="All 2 branches missed.">            if (!file.exists())     //if file does not exist, create a file</span>
<span class="nc" id="L97">                file.createNewFile();</span>
            
<span class="nc bnc" id="L99" title="All 2 branches missed.">            if (file.length()==0)   //if file does not have content it is invalid</span>
<span class="nc" id="L100">                return false;</span>

<span class="nc" id="L102">            return true;            //else it is valid</span>
<span class="nc" id="L103">        } catch (IOException e) {</span>
<span class="nc" id="L104">            System.out.println(&quot;An error occurred.&quot;);</span>
<span class="nc" id="L105">            e.printStackTrace();</span>
<span class="nc" id="L106">            return false;</span>
        }
    }

    public void simulateVocabConstruction()
    {
<span class="nc" id="L112">        int numOfDocuments = trainData.length;</span>

        //initializes number of documents
<span class="nc bnc" id="L115" title="All 2 branches missed.">        for (int i=0; i&lt;numOfDocuments; i++)</span>
<span class="nc" id="L116">            tempVocab.increaseTotalDocs();</span>

        //Loop through document data
<span class="nc bnc" id="L119" title="All 2 branches missed.">        for (String data: trainData)</span>
        {
<span class="nc" id="L121">            String[] values = data.split(&quot;,&quot;);</span>

<span class="nc bnc" id="L123" title="All 2 branches missed.">            for (int i=0; i&lt;values.length-1; i++)</span>
            {
<span class="nc" id="L125">                double weight = Double.parseDouble(values[i]); //0 if not in doc, any number if in doc</span>
<span class="nc bnc" id="L126" title="All 2 branches missed.">                if (weight!=0)</span>
<span class="nc" id="L127">                    tempVocab.addWord(vocabWords[i]);</span>
            }
        }
<span class="nc" id="L130">    }</span>

    public Instances dataExtractionWithData()   //when adding take into account all files containing word using simulated vocab
    {
<span class="nc" id="L134">        ArrayList&lt;Attribute&gt; attrInfo = new ArrayList&lt;Attribute&gt;();</span>

<span class="nc bnc" id="L136" title="All 2 branches missed.">        for (String word: vocabWords)</span>
        {
<span class="nc" id="L138">            Attribute attr = new Attribute(word);</span>
<span class="nc" id="L139">            attrInfo.add(attr);</span>
        }

        //create and add category attribute
<span class="nc" id="L143">        ArrayList&lt;String&gt; categoryList = new ArrayList&lt;String&gt;();</span>
<span class="nc" id="L144">        categoryList.addAll(Arrays.asList(categoryKeys));</span>
<span class="nc" id="L145">        Attribute category = new Attribute(&quot;category&quot;, categoryList);</span>
<span class="nc" id="L146">        attrInfo.add(category);</span>

<span class="nc" id="L148">        final int numOfAttributes = attrInfo.size();</span>

<span class="nc" id="L150">        Instances training = new Instances(&quot;TrainingData&quot;, attrInfo, trainData.length);</span>
<span class="nc" id="L151">        training.setClass(category);</span>

<span class="nc bnc" id="L153" title="All 2 branches missed.">        for (String data: trainData)</span>
        {
<span class="nc" id="L155">            String[] values = data.split(&quot;,&quot;);</span>
<span class="nc" id="L156">            Instance instance = new DenseInstance(numOfAttributes);</span>
<span class="nc" id="L157">            instance.setDataset(training);</span>
            
<span class="nc" id="L159">            int i = 0;</span>
<span class="nc bnc" id="L160" title="All 2 branches missed.">            for (; i&lt;values.length-1; i++)</span>
<span class="nc" id="L161">                instance.setValue(i, Double.parseDouble(values[i]));</span>

<span class="nc" id="L163">            instance.setValue(i, values[i]);</span>
            
<span class="nc" id="L165">            training.add(instance);</span>
        }

<span class="nc" id="L168">        return training;</span>
    }

    public void outputToARFF(Instances training, String arffPath)
    {
        try
        {
<span class="nc" id="L175">            DataSink.write(arffPath, training);</span>
        }
<span class="nc" id="L177">        catch (Exception e)</span>
        {
<span class="nc" id="L179">            System.out.println(&quot;Failed to save to: &quot; + arffPath);</span>
<span class="nc" id="L180">            e.printStackTrace();</span>
<span class="nc" id="L181">        }</span>
<span class="nc" id="L182">    }</span>

    public VocabCollection getVocab()
    {
<span class="nc" id="L186">        return tempVocab;</span>
    }

    public String[] getTrainData()
    {
<span class="nc" id="L191">        return trainData;</span>
    }

    public String[] getVocabWords()
    {
<span class="nc" id="L196">        return vocabWords;</span>
    }
    
}

         //DO NOT DELETE PAST THIS POINT
//-------------------------------------------------
//************ FilePath Flow (Tabled) *************
//-------------------------------------------------

// public class InitialTrainer 
// {
//     private final String[] categoryKeys = {&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;, &quot;F&quot;, &quot;G&quot;, &quot;H&quot;, &quot;I&quot;, &quot;J&quot;, &quot;K&quot;};
//     private String[] trainFilePaths;     
//     private String[] fileCategories;         //these are categoryKeys
//     private List&lt;Document&gt; listOfDocuments = new ArrayList&lt;Document&gt;();
//     VocabCollection vocab;

//     public InitialTrainer()
//     {
//         String[] tempFilePaths = {&quot;&quot;};  //Tabled: put sample data files hardcoded in
//         String[] tempCategories = {&quot;&quot;}; //Tabled: put categories hardcoded in
//         trainFilePaths = tempFilePaths;
//         fileCategories = tempCategories;
//     }

//     //For Testing Purposes
//     public InitialTrainer(String[] tempFilePaths, String[] tempCategories)
//     {
//         trainFilePaths = tempFilePaths;
//         fileCategories = tempCategories;
//     }

//     
// /**
//  * a test for the future
//  */
// public void run()
//     {
//         String arffPath = &quot;acmclass-data/train.arff&quot;;
//         if (validARFFPresent(arffPath))
//             return;

//         //FilePath Flow (With ArffGenerator)
//         constructInitialData();
//         ArffGenerator generator = new ArffGenerator(arffPath, vocab);
//         generator.generateInstances(listOfDocuments);
//         generator.outputToARFF();
//     }

//     public boolean validARFFPresent(String arffPath)
//     {
//         File file = new File(arffPath);
//         try {
//             if (!file.exists())     //if file does not exist, create a file
//                 file.createNewFile();
            
//             if (file.length()==0)   //if file does not have content it is invalid
//                 return false;

//             return true;            //else it is valid
//         } catch (IOException e) {
//             System.out.println(&quot;An error occurred.&quot;);
//             e.printStackTrace();
//             return false;
//         }
//     }

//     public void constructInitialData()
//     {
//         List&lt;TrainDocument&gt; trainDocs = new ArrayList&lt;TrainDocument&gt;();
//         String stopPath = &quot;acmclass-data/stopWords.txt&quot;;
//         String vocabPath = &quot;acmclass-data/vocabCollection.txt&quot;;
//         File vocabFile = new File(vocabPath);
//         if (vocabFile.exists()) //assure fresh vocab is created
//             vocabFile.delete();
//         TrainParser tParser = new TrainParser(new StopList(stopPath), vocabPath);   //no path exists so constructor creates a new vocabFile

//         int i = 0;
//         for (String path: trainFilePaths)
//         {
//             trainDocs.add(tParser.createDocument(path, fileCategories[i]));    //category supplied is a key
//             i++;
//         }
       
//         vocab = tParser.getVocabCollection();
//         vocab.calcInverseDocFrequency();

//         for (TrainDocument doc: trainDocs)
//         {
//             doc.calculateTermWeights(vocab);
//             listOfDocuments.add((Document)doc);
//         }
    
//         //tParser.writeOutVocabWrapper(vocabPath);
//         vocab.writeOutVocab(vocabPath);        
//     }

//     public String[] getFilePaths()
//     {
//         return trainFilePaths;
//     }

//     public String[] getFileCategories()
//     {
//         return fileCategories;
//     }

//     public VocabCollection getVocab()
//     {
//         return tempVocab;
//     }

//     public List&lt;Document&gt; getListOfDocs()
//     {
//         return listOfDocuments;
//     }
// }
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>